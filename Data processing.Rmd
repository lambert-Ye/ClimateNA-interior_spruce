---
title: "Manuscript code"
author: "Zhengyang Lambert Ye"
---
# data import
```{r}
install.packages("dplyr","Rcpp","CEMT")
library(dplyr);library(Rcpp);library(CEMT)
climate.o <- read.csv("Sx weather data 2011-2018.csv",header = TRUE, sep=",");head(climate.o)
# class
tem <- as.numeric(as.character(climate.o$temp));head(tem)
pre <- as.numeric(as.character(climate.o$rain));head(pre)
dt2 <- data.frame(climate.o[,c(3,6:10)],tem,pre);head(dt2);str(dt2)
dt3 <- na.omit(dt2);dt3
```
# Part 1 Comparison between data from sites and ClimateNA
# imputation and aggregation to month level
# the number of * means the class of data mistakes, "." means perfect. 
## cranbrook: 2010.11 - 2017.6; missing 2013.8 - 2015.6 *** imputation based on nakusp and duncanlake
```{r}
cranbrook.o <- dt3[dt3$Site == "cranbrook",]
cranbrook.prec.month <- arrange(aggregate(cranbrook.o[,8],by=list(site=cranbrook.o$Site,year=cranbrook.o$year,month=cranbrook.o$month),FUN=sum),year,month)
cranbrook.temp.day.min <- aggregate(cranbrook.o[,7],by=list(site=cranbrook.o$Site,year=cranbrook.o$year,month=cranbrook.o$month,day=cranbrook.o$day),FUN=min)
cranbrook.temp.month.min <- arrange(aggregate(cranbrook.temp.day.min[,5],by=list(site=cranbrook.temp.day.min$site,year=cranbrook.temp.day.min$year,month=cranbrook.temp.day.min$month),FUN=mean),year,month)
cranbrook.temp.day.max <- aggregate(cranbrook.o[,7],by=list(site=cranbrook.o$Site,year=cranbrook.o$year,month=cranbrook.o$month,day=cranbrook.o$day),FUN=max)
cranbrook.temp.month.max <- arrange(aggregate(cranbrook.temp.day.max[,5],by=list(site=cranbrook.temp.day.max$site,year=cranbrook.temp.day.max$year,month=cranbrook.temp.day.max$month),FUN=mean),year,month)
cranbrook.temp.month.mean <- arrange(aggregate(cranbrook.o[,7],by=list(site=cranbrook.o$Site,year=cranbrook.o$year,month=cranbrook.o$month),FUN=mean),year,month)
cranbrook.temp.month <- cbind.data.frame(cranbrook.temp.month.mean,cranbrook.temp.month.min$x,cranbrook.temp.month.max$x)
cranbrook <- cbind.data.frame(cranbrook.temp.month,cranbrook.prec.month$x)
names(cranbrook) <- c("site","year","month","mean","min","max","prec")
site <- rep("cranbrook",times=21)
year <- as.numeric(c(rep(2013,times=4),rep(2014,times=12),rep(2017,times=5)))
month <- as.numeric(c(9:12,1:12,1:5))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=21))
cranbrook.month.add <- cbind(site,year,month,mean,min,max,prec)
cranbrook <- rbind.data.frame(cranbrook[1:35,],cranbrook.month.add,cranbrook[36:nrow(cranbrook),])
write.csv(cranbrook,"cranbrook.csv",sep=",")
cranbrook <- read.csv("cranbrook.csv",sep=",")
cranbrook <- cranbrook[,-1] 
```

## duncanlake: perfect, 2010.9 - 2016.12 .
```{r}
duncanlake.o <- dt3[dt3$Site == "duncanlake",]
duncanlake.prec.month <- arrange(aggregate(duncanlake.o[,8],by=list(site=duncanlake.o$Site,year=duncanlake.o$year,month=duncanlake.o$month),FUN=sum),year,month)
duncanlake.temp.day.min <- aggregate(duncanlake.o[,7],by=list(site=duncanlake.o$Site,year=duncanlake.o$year,month=duncanlake.o$month,day=duncanlake.o$day),FUN=min)
duncanlake.temp.month.min <- arrange(aggregate(duncanlake.temp.day.min[,5],by=list(site=duncanlake.temp.day.min$site,year=duncanlake.temp.day.min$year,month=duncanlake.temp.day.min$month),FUN=mean),year,month)
duncanlake.temp.day.max <- aggregate(duncanlake.o[,7],by=list(site=duncanlake.o$Site,year=duncanlake.o$year,month=duncanlake.o$month,day=duncanlake.o$day),FUN=max)
duncanlake.temp.month.max <- arrange(aggregate(duncanlake.temp.day.max[,5],by=list(site=duncanlake.temp.day.max$site,year=duncanlake.temp.day.max$year,month=duncanlake.temp.day.max$month),FUN=mean),year,month)
duncanlake.temp.month.mean <- arrange(aggregate(duncanlake.o[,7],by=list(site=duncanlake.o$Site,year=duncanlake.o$year,month=duncanlake.o$month),FUN=mean),year,month)
duncanlake.temp.month <- cbind.data.frame(duncanlake.temp.month.mean,duncanlake.temp.month.min$x,duncanlake.temp.month.max$x)
duncanlake <- cbind.data.frame(duncanlake.temp.month,duncanlake.prec.month$x)
names(duncanlake) <- c("site","year","month","mean","min","max","prec")
write.csv(duncanlake,"duncanlake.csv",sep=",") 

```

## harrison: missing too much, only two periods of observation: 2010.10 - 2013.3, 2014.10 - 2015.2 *****

## highlevel: 2010.10 - 2018.11, missing 2016.10 - 2017.10 ** (won't affect thesis) no close site
```{r}
highlevel.o <- dt3[dt3$Site == "highlevel",]
highlevel.prec.month <- arrange(aggregate(highlevel.o[,8],by=list(site=highlevel.o$Site,year=highlevel.o$year,month=highlevel.o$month),FUN=sum),year,month)
highlevel.temp.day.min <- aggregate(highlevel.o[,7],by=list(site=highlevel.o$Site,year=highlevel.o$year,month=highlevel.o$month,day=highlevel.o$day),FUN=min)
highlevel.temp.month.min <- arrange(aggregate(highlevel.temp.day.min[,5],by=list(site=highlevel.temp.day.min$site,year=highlevel.temp.day.min$year,month=highlevel.temp.day.min$month),FUN=mean),year,month)
highlevel.temp.day.max <- aggregate(highlevel.o[,7],by=list(site=highlevel.o$Site,year=highlevel.o$year,month=highlevel.o$month,day=highlevel.o$day),FUN=max)
highlevel.temp.month.max <- arrange(aggregate(highlevel.temp.day.max[,5],by=list(site=highlevel.temp.day.max$site,year=highlevel.temp.day.max$year,month=highlevel.temp.day.max$month),FUN=mean),year,month)
highlevel.temp.month.mean <- arrange(aggregate(highlevel.o[,7],by=list(site=highlevel.o$Site,year=highlevel.o$year,month=highlevel.o$month),FUN=mean),year,month)
highlevel.temp.month <- cbind.data.frame(highlevel.temp.month.mean,highlevel.temp.month.min$x,highlevel.temp.month.max$x)
highlevel <- cbind.data.frame(highlevel.temp.month,highlevel.prec.month$x)
names(highlevel) <- c("site","year","month","mean","min","max","prec")
site <- rep("highlevel",times=11)
year <- as.numeric(c(rep(2016,times=2),rep(2017,times=9)))
month <- as.numeric(c(11:12,1:9))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=11))
highlevel.month.add <- cbind(site,year,month,mean,min,max,prec)
highlevel <- rbind.data.frame(highlevel[1:73,],highlevel.month.add,highlevel[74:nrow(highlevel),])
write.csv(highlevel,"highlevel.csv",sep=",")
```

## jordanriver: 2010.11 - 2018.12 missing 2013.7 - 2013.11, double counting 2013.12 - 2014.12 ** no close site, hard for imputation.
```{r}
jordanriver.o <- dt3[dt3$Site == "jordanriver",]
jordanriver.prec.month <- arrange(aggregate(jordanriver.o[,8],by=list(site=jordanriver.o$Site,year=jordanriver.o$year,month=jordanriver.o$month),FUN=sum),year,month)
jordanriver.temp.day.min <- aggregate(jordanriver.o[,7],by=list(site=jordanriver.o$Site,year=jordanriver.o$year,month=jordanriver.o$month,day=jordanriver.o$day),FUN=min)
jordanriver.temp.month.min <- arrange(aggregate(jordanriver.temp.day.min[,5],by=list(site=jordanriver.temp.day.min$site,year=jordanriver.temp.day.min$year,month=jordanriver.temp.day.min$month),FUN=mean),year,month)
jordanriver.temp.day.max <- aggregate(jordanriver.o[,7],by=list(site=jordanriver.o$Site,year=jordanriver.o$year,month=jordanriver.o$month,day=jordanriver.o$day),FUN=max)
jordanriver.temp.month.max <- arrange(aggregate(jordanriver.temp.day.max[,5],by=list(site=jordanriver.temp.day.max$site,year=jordanriver.temp.day.max$year,month=jordanriver.temp.day.max$month),FUN=mean),year,month)
jordanriver.temp.month.mean <- arrange(aggregate(jordanriver.o[,7],by=list(site=jordanriver.o$Site,year=jordanriver.o$year,month=jordanriver.o$month),FUN=mean),year,month)
jordanriver.temp.month <- cbind.data.frame(jordanriver.temp.month.mean,jordanriver.temp.month.min$x,jordanriver.temp.month.max$x)
jordanriver <- cbind.data.frame(jordanriver.temp.month,jordanriver.prec.month$x)
names(jordanriver) <- c("site","year","month","mean","min","max","prec")

site <- rep("jordanriver",times=3)
year <- as.numeric(rep(2013,times=3))
month <- as.numeric(c(8,9,10))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=3))
jordanriver.month.add <- cbind(site,year,month,mean,min,max,prec)
jordanriver <- rbind.data.frame(jordanriver[1:33,],jordanriver.month.add,jordanriver[34:nrow(jordanriver),])

jordanriver.test <- rbind.data.frame(jordanriver[1:33,],jordanriver.month.add,jordanriver[34:nrow(jordanriver),])

write.csv(jordanriver,"jordanriver.csv",sep=",")
jordanriver <- read.csv("jordanriver.csv",sep=",")
jordanriver <- jordanriver[,-1]

```

## mayo: 2010.8 - 2016.9, missing 2011.10 - 2012.12, double counting 2013.1 - 2013.5 **** no close site, hard for imputation
```{r}
mayo.o <- dt3[dt3$Site == "mayo",]
mayo.prec.month <- arrange(aggregate(mayo.o[,8],by=list(site=mayo.o$Site,year=mayo.o$year,month=mayo.o$month),FUN=sum),year,month)
mayo.temp.day.min <- aggregate(mayo.o[,7],by=list(site=mayo.o$Site,year=mayo.o$year,month=mayo.o$month,day=mayo.o$day),FUN=min)
mayo.temp.month.min <- arrange(aggregate(mayo.temp.day.min[,5],by=list(site=mayo.temp.day.min$site,year=mayo.temp.day.min$year,month=mayo.temp.day.min$month),FUN=mean),year,month)
mayo.temp.day.max <- aggregate(mayo.o[,7],by=list(site=mayo.o$Site,year=mayo.o$year,month=mayo.o$month,day=mayo.o$day),FUN=max)
mayo.temp.month.max <- arrange(aggregate(mayo.temp.day.max[,5],by=list(site=mayo.temp.day.max$site,year=mayo.temp.day.max$year,month=mayo.temp.day.max$month),FUN=mean),year,month)
mayo.temp.month.mean <- arrange(aggregate(mayo.o[,7],by=list(site=mayo.o$Site,year=mayo.o$year,month=mayo.o$month),FUN=mean),year,month)
mayo.temp.month <- cbind.data.frame(mayo.temp.month.mean,mayo.temp.month.min$x,mayo.temp.month.max$x)
mayo <- cbind.data.frame(mayo.temp.month,mayo.prec.month$x)
names(mayo) <- c("site","year","month","mean","min","max","prec")

site <- rep("mayo",times=14)
year <- as.numeric(c(rep(2011,times=2),rep(2012,times=12)))
month <- as.numeric(c(11:12,1:12))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=14))
mayo.month.add <- cbind(site,year,month,mean,min,max,prec)
mayo <- rbind.data.frame(mayo[1:15,],mayo.month.add,mayo[16:nrow(mayo),])
write.csv(mayo,"mayo.csv",sep=",")
mayo <- read.csv("mayo.csv",sep=",")
mayo <- mayo[,-1]
```

## nakusp: 2010.9 - 2018.8, missing 2012.7 - 2012.11 *imputation based on cranbrook and revelstoke
```{r}
nakusp.o <- dt3[dt3$Site == "nakusp",]
nakusp.prec.month <- arrange(aggregate(nakusp.o[,8],by=list(site=nakusp.o$Site,year=nakusp.o$year,month=nakusp.o$month),FUN=sum),year,month)
nakusp.temp.day.min <- aggregate(nakusp.o[,7],by=list(site=nakusp.o$Site,year=nakusp.o$year,month=nakusp.o$month,day=nakusp.o$day),FUN=min)
nakusp.temp.month.min <- arrange(aggregate(nakusp.temp.day.min[,5],by=list(site=nakusp.temp.day.min$site,year=nakusp.temp.day.min$year,month=nakusp.temp.day.min$month),FUN=mean),year,month)
nakusp.temp.day.max <- aggregate(nakusp.o[,7],by=list(site=nakusp.o$Site,year=nakusp.o$year,month=nakusp.o$month,day=nakusp.o$day),FUN=max)
nakusp.temp.month.max <- arrange(aggregate(nakusp.temp.day.max[,5],by=list(site=nakusp.temp.day.max$site,year=nakusp.temp.day.max$year,month=nakusp.temp.day.max$month),FUN=mean),year,month)
nakusp.temp.month.mean <- arrange(aggregate(nakusp.o[,7],by=list(site=nakusp.o$Site,year=nakusp.o$year,month=nakusp.o$month),FUN=mean),year,month)
nakusp.temp.month <- cbind.data.frame(nakusp.temp.month.mean,nakusp.temp.month.min$x,nakusp.temp.month.max$x)
nakusp <- cbind.data.frame(nakusp.temp.month,nakusp.prec.month$x)
names(nakusp) <- c("site","year","month","mean","min","max","prec")
site <- rep("nakusp",times=3)
year <- as.numeric(rep(2012,times=3))
month <- as.numeric(c(8,9,10))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=3))
nakusp.month.add <- cbind(site,year,month,mean,min,max,prec)
nakusp <- rbind.data.frame(nakusp[1:23,],nakusp.month.add,nakusp[24:nrow(nakusp),])
write.csv(nakusp,"nakusp.csv",sep=",")
nakusp <- read.csv("nakusp.csv",sep=",")
nakusp <- nakusp[,-1]
```

## parship: 2010.10 - 2018.7, missing 2011.6 - 2011.10 double & triple counting 2015.7 - 2017.7 ** imputation based on pinepass
```{r}
parsnip.o <- dt3[dt3$Site == "parsnip",]
write.csv(parsnip.o,"parsnip_o.csv",sep=",") #delete counting overlaps
parsnip.o <- read.csv("parsnip_o.csv",sep=",")
parsnip.o <- parsnip.o[,-1] #don't run this!!!!

parsnip.prec.month <- arrange(aggregate(parsnip.o[,8],by=list(site=parsnip.o$Site,year=parsnip.o$year,month=parsnip.o$month),FUN=sum),year,month)
parsnip.temp.day.min <- aggregate(parsnip.o[,7],by=list(site=parsnip.o$Site,year=parsnip.o$year,month=parsnip.o$month,day=parsnip.o$day),FUN=min)
parsnip.temp.month.min <- arrange(aggregate(parsnip.temp.day.min[,5],by=list(site=parsnip.temp.day.min$site,year=parsnip.temp.day.min$year,month=parsnip.temp.day.min$month),FUN=mean),year,month)
parsnip.temp.day.max <- aggregate(parsnip.o[,7],by=list(site=parsnip.o$Site,year=parsnip.o$year,month=parsnip.o$month,day=parsnip.o$day),FUN=max)
parsnip.temp.month.max <- arrange(aggregate(parsnip.temp.day.max[,5],by=list(site=parsnip.temp.day.max$site,year=parsnip.temp.day.max$year,month=parsnip.temp.day.max$month),FUN=mean),year,month)
parsnip.temp.month.mean <- arrange(aggregate(parsnip.o[,7],by=list(site=parsnip.o$Site,year=parsnip.o$year,month=parsnip.o$month),FUN=mean),year,month)
parsnip.temp.month <- cbind.data.frame(parsnip.temp.month.mean,parsnip.temp.month.min$x,parsnip.temp.month.max$x)
parsnip <- cbind.data.frame(parsnip.temp.month,parsnip.prec.month$x)
names(parsnip) <- c("site","year","month","mean","min","max","prec")

site <- rep("parsnip",times=3)
year <- as.numeric(rep(2011,times=3))
month <- as.numeric(c(7,8,9))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=3))
parsnip.month.add <- cbind(site,year,month,mean,min,max,prec)
parsnip <- rbind.data.frame(parsnip[1:9,],parsnip.month.add,parsnip[10:nrow(parsnip),])
write.csv(parsnip,"parsnip.csv",sep=",")

parsnip <- read.csv("parsnip.csv",sep=",")
parsnip <- parsnip[,-1]
```

## pinepass: 2010.8 - 2018.6, missing 2014.9 - 2015.7, double & triple counting 2015.10 - 2017.7 ** imputation based on parsnip
```{r}
pinepass.o <- dt3[dt3$Site == "pinepass",]
write.csv(pinepass.o,"pinepass_o.csv",sep=",") #delete counting overlaps
pinepass.o <- read.csv("pinepass_o.csv",sep=",")
pinepass.o <- pinepass.o[,-1] #don't run this!!!!

pinepass.prec.month <- arrange(aggregate(pinepass.o[,8],by=list(site=pinepass.o$Site,year=pinepass.o$year,month=pinepass.o$month),FUN=sum),year,month)
pinepass.temp.day.min <- aggregate(pinepass.o[,7],by=list(site=pinepass.o$Site,year=pinepass.o$year,month=pinepass.o$month,day=pinepass.o$day),FUN=min)
pinepass.temp.month.min <- arrange(aggregate(pinepass.temp.day.min[,5],by=list(site=pinepass.temp.day.min$site,year=pinepass.temp.day.min$year,month=pinepass.temp.day.min$month),FUN=mean),year,month)
pinepass.temp.day.max <- aggregate(pinepass.o[,7],by=list(site=pinepass.o$Site,year=pinepass.o$year,month=pinepass.o$month,day=pinepass.o$day),FUN=max)
pinepass.temp.month.max <- arrange(aggregate(pinepass.temp.day.max[,5],by=list(site=pinepass.temp.day.max$site,year=pinepass.temp.day.max$year,month=pinepass.temp.day.max$month),FUN=mean),year,month)
pinepass.temp.month.mean <- arrange(aggregate(pinepass.o[,7],by=list(site=pinepass.o$Site,year=pinepass.o$year,month=pinepass.o$month),FUN=mean),year,month)
pinepass.temp.month <- cbind.data.frame(pinepass.temp.month.mean,pinepass.temp.month.min$x,pinepass.temp.month.max$x)
pinepass <- cbind.data.frame(pinepass.temp.month,pinepass.prec.month$x)
names(pinepass) <- c("site","year","month","mean","min","max","prec")

site <- rep("pinepass",times=9)
year <- as.numeric(rep(2014,times=3),rep(2015,times=6))
month <- as.numeric(c(10:12,1:6))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=9))
pinepass.month.add <- cbind(site,year,month,mean,min,max,prec)
pinepass <- rbind.data.frame(pinepass[1:50,],pinepass.month.add,pinepass[51:nrow(pinepass),])
write.csv(pinepass,"pinepass.csv",sep=",")

pinepass <- read.csv("pinepass.csv",sep=",")
pinepass <- pinepass[,-1]
```

## revelstoke: 2010.9 - 2018.3 missing 2017.4 - 2017.7 * (won't affect manuscript) imputation based on nakusp
```{r}
revelstoke.o <- dt3[dt3$Site == "revelstoke",]
revelstoke.prec.month <- arrange(aggregate(revelstoke.o[,8],by=list(site=revelstoke.o$Site,year=revelstoke.o$year,month=revelstoke.o$month),FUN=sum),year,month)
revelstoke.temp.day.min <- aggregate(revelstoke.o[,7],by=list(site=revelstoke.o$Site,year=revelstoke.o$year,month=revelstoke.o$month,day=revelstoke.o$day),FUN=min)
revelstoke.temp.month.min <- arrange(aggregate(revelstoke.temp.day.min[,5],by=list(site=revelstoke.temp.day.min$site,year=revelstoke.temp.day.min$year,month=revelstoke.temp.day.min$month),FUN=mean),year,month)
revelstoke.temp.day.max <- aggregate(revelstoke.o[,7],by=list(site=revelstoke.o$Site,year=revelstoke.o$year,month=revelstoke.o$month,day=revelstoke.o$day),FUN=max)
revelstoke.temp.month.max <- arrange(aggregate(revelstoke.temp.day.max[,5],by=list(site=revelstoke.temp.day.max$site,year=revelstoke.temp.day.max$year,month=revelstoke.temp.day.max$month),FUN=mean),year,month)
revelstoke.temp.month.mean <- arrange(aggregate(revelstoke.o[,7],by=list(site=revelstoke.o$Site,year=revelstoke.o$year,month=revelstoke.o$month),FUN=mean),year,month)
revelstoke.temp.month <- cbind.data.frame(revelstoke.temp.month.mean,revelstoke.temp.month.min$x,revelstoke.temp.month.max$x)
revelstoke <- cbind.data.frame(revelstoke.temp.month,revelstoke.prec.month$x)
names(revelstoke) <- c("site","year","month","mean","min","max","prec")
site <- rep("revelstoke",times=2)
year <- as.numeric(rep(2017,times=2))
month <- as.numeric(c(5,6))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=2))
revelstoke.month.add <- cbind(site,year,month,mean,min,max,prec)
revelstoke <- rbind.data.frame(revelstoke[1:80,],revelstoke.month.add,revelstoke[81:nrow(revelstoke),])
write.csv(revelstoke,"revelstoke.csv",sep=",")
revelstoke <- read.csv("revelstoke.csv",sep=",")
revelstoke <- revelstoke[,-1]
```

## skimikin: 2010.8 - 2017.9, missing 2011.1 - 2011.10 imputation based on duncanlake
```{r}
skimikin.o <- dt3[dt3$Site == "skimikin",]
skimikin.prec.month <- arrange(aggregate(skimikin.o[,8],by=list(site=skimikin.o$Site,year=skimikin.o$year,month=skimikin.o$month),FUN=sum),year,month)
skimikin.temp.day.min <- aggregate(skimikin.o[,7],by=list(site=skimikin.o$Site,year=skimikin.o$year,month=skimikin.o$month,day=skimikin.o$day),FUN=min)
skimikin.temp.month.min <- arrange(aggregate(skimikin.temp.day.min[,5],by=list(site=skimikin.temp.day.min$site,year=skimikin.temp.day.min$year,month=skimikin.temp.day.min$month),FUN=mean),year,month)
skimikin.temp.day.max <- aggregate(skimikin.o[,7],by=list(site=skimikin.o$Site,year=skimikin.o$year,month=skimikin.o$month,day=skimikin.o$day),FUN=max)
skimikin.temp.month.max <- arrange(aggregate(skimikin.temp.day.max[,5],by=list(site=skimikin.temp.day.max$site,year=skimikin.temp.day.max$year,month=skimikin.temp.day.max$month),FUN=mean),year,month)
skimikin.temp.month.mean <- arrange(aggregate(skimikin.o[,7],by=list(site=skimikin.o$Site,year=skimikin.o$year,month=skimikin.o$month),FUN=mean),year,month)
skimikin.temp.month <- cbind.data.frame(skimikin.temp.month.mean,skimikin.temp.month.min$x,skimikin.temp.month.max$x)
skimikin <- cbind.data.frame(skimikin.temp.month,skimikin.prec.month$x)
names(skimikin) <- c("site","year","month","mean","min","max","prec")
site <- rep("skimikin",times=8)
year <- as.numeric(rep(2011,times=8))
month <- as.numeric(2:9)
min <- max <- prec <- mean <- as.numeric(rep(NA,times=8))
skimikin.month.add <- cbind(site,year,month,mean,min,max,prec)
skimikin <- rbind.data.frame(skimikin[1:6,],skimikin.month.add,skimikin[7:nrow(skimikin),])
write.csv(skimikin,"skimikin.csv",sep=",")
skimikin <- read.csv("skimikin.csv",sep=",")
skimikin <- skimikin[,-1]
```

## terrace: 2010.8 - 2015.10 missing 2014.6 -2014.8 *  
```{r}
terrace.o <- dt3[dt3$Site == "terrace",]
terrace.prec.month <- arrange(aggregate(terrace.o[,8],by=list(site=terrace.o$Site,year=terrace.o$year,month=terrace.o$month),FUN=sum),year,month)
terrace.temp.day.min <- aggregate(terrace.o[,7],by=list(site=terrace.o$Site,year=terrace.o$year,month=terrace.o$month,day=terrace.o$day),FUN=min)
terrace.temp.month.min <- arrange(aggregate(terrace.temp.day.min[,5],by=list(site=terrace.temp.day.min$site,year=terrace.temp.day.min$year,month=terrace.temp.day.min$month),FUN=mean),year,month)
terrace.temp.day.max <- aggregate(terrace.o[,7],by=list(site=terrace.o$Site,year=terrace.o$year,month=terrace.o$month,day=terrace.o$day),FUN=max)
terrace.temp.month.max <- arrange(aggregate(terrace.temp.day.max[,5],by=list(site=terrace.temp.day.max$site,year=terrace.temp.day.max$year,month=terrace.temp.day.max$month),FUN=mean),year,month)
terrace.temp.month.mean <- arrange(aggregate(terrace.o[,7],by=list(site=terrace.o$Site,year=terrace.o$year,month=terrace.o$month),FUN=mean),year,month)
terrace.temp.month <- cbind.data.frame(terrace.temp.month.mean,terrace.temp.month.min$x,terrace.temp.month.max$x)
terrace <- cbind.data.frame(terrace.temp.month,terrace.prec.month$x)
names(terrace) <- c("site","year","month","mean","min","max","prec")
write.csv(terrace,"terrace.csv",sep=",")
```

##tetejaune: 2010.9 - 2017.10 missing 2015.4 - 2015.7, 2015.7 - 2016.7, 2016.8 - 2017.7 Too fragile, I choose to delete the data after 2015 (won't affect manuscript) ***
```{r}
tetejaune.o <- dt3[dt3$Site == "tetejaune",]
tetejaune.prec.month <- arrange(aggregate(tetejaune.o[,8],by=list(site=tetejaune.o$Site,year=tetejaune.o$year,month=tetejaune.o$month),FUN=sum),year,month)
tetejaune.temp.day.min <- aggregate(tetejaune.o[,7],by=list(site=tetejaune.o$Site,year=tetejaune.o$year,month=tetejaune.o$month,day=tetejaune.o$day),FUN=min)
tetejaune.temp.month.min <- arrange(aggregate(tetejaune.temp.day.min[,5],by=list(site=tetejaune.temp.day.min$site,year=tetejaune.temp.day.min$year,month=tetejaune.temp.day.min$month),FUN=mean),year,month)
tetejaune.temp.day.max <- aggregate(tetejaune.o[,7],by=list(site=tetejaune.o$Site,year=tetejaune.o$year,month=tetejaune.o$month,day=tetejaune.o$day),FUN=max)
tetejaune.temp.month.max <- arrange(aggregate(tetejaune.temp.day.max[,5],by=list(site=tetejaune.temp.day.max$site,year=tetejaune.temp.day.max$year,month=tetejaune.temp.day.max$month),FUN=mean),year,month)
tetejaune.temp.month.mean <- arrange(aggregate(tetejaune.o[,7],by=list(site=tetejaune.o$Site,year=tetejaune.o$year,month=tetejaune.o$month),FUN=mean),year,month)
tetejaune.temp.month <- cbind.data.frame(tetejaune.temp.month.mean,tetejaune.temp.month.min$x,tetejaune.temp.month.max$x)
tetejaune <- cbind.data.frame(tetejaune.temp.month,tetejaune.prec.month$x)
names(tetejaune) <- c("site","year","month","mean","min","max","prec")
tetejaune <- tetejaune[-56:-63,]
write.csv(tetejaune,"tetejaune.csv",sep=",")
```

## Wells: 2010.10 - 2018.7 missing: 2012.9 - 2013.7, double $ triple 2014.9 - 2016.7 *** imputation based on Tete and Parsnip
```{r}
Wells.o <- dt3[dt3$Site == "Wells",]
write.csv(Wells.o,"Wells_o.csv",sep=",") #delete counting overlaps
Wells.o <- read.csv("Wells_o.csv",sep=",")
Wells.o <- Wells.o[,-1] #don't run this!!!!

Wells.prec.month <- arrange(aggregate(Wells.o[,8],by=list(site=Wells.o$Site,year=Wells.o$year,month=Wells.o$month),FUN=sum),year,month)
Wells.temp.day.min <- aggregate(Wells.o[,7],by=list(site=Wells.o$Site,year=Wells.o$year,month=Wells.o$month,day=Wells.o$day),FUN=min)
Wells.temp.month.min <- arrange(aggregate(Wells.temp.day.min[,5],by=list(site=Wells.temp.day.min$site,year=Wells.temp.day.min$year,month=Wells.temp.day.min$month),FUN=mean),year,month)
Wells.temp.day.max <- aggregate(Wells.o[,7],by=list(site=Wells.o$Site,year=Wells.o$year,month=Wells.o$month,day=Wells.o$day),FUN=max)
Wells.temp.month.max <- arrange(aggregate(Wells.temp.day.max[,5],by=list(site=Wells.temp.day.max$site,year=Wells.temp.day.max$year,month=Wells.temp.day.max$month),FUN=mean),year,month)
Wells.temp.month.mean <- arrange(aggregate(Wells.o[,7],by=list(site=Wells.o$Site,year=Wells.o$year,month=Wells.o$month),FUN=mean),year,month)
Wells.temp.month <- cbind.data.frame(Wells.temp.month.mean,Wells.temp.month.min$x,Wells.temp.month.max$x)
Wells <- cbind.data.frame(Wells.temp.month,Wells.prec.month$x)
names(Wells) <- c("site","year","month","mean","min","max","prec")

site <- rep("Wells",times=9)
year <- as.numeric(rep(2012,times=3),rep(2013,times=6))
month <- as.numeric(c(10:12,1:6))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=9))
Wells.month.add <- cbind(site,year,month,mean,min,max,prec)
Wells <- rbind.data.frame(Wells[1:24,],Wells.month.add,Wells[25:nrow(Wells),])
write.csv(Wells,"Wells.csv",sep=",")

Wells <- read.csv("Wells.csv",sep=",")
Wells <- Wells[,-1]
```
 
## Whitecourt: 2010.9 - 2018.10, missing 2016.10 - 2017.8 (won't affect thesis) ** no close site
```{r}
Whitecourt.o <- dt3[dt3$Site == "Whitecourt",]
Whitecourt.prec.month <- arrange(aggregate(Whitecourt.o[,8],by=list(site=Whitecourt.o$Site,year=Whitecourt.o$year,month=Whitecourt.o$month),FUN=sum),year,month)
Whitecourt.temp.day.min <- aggregate(Whitecourt.o[,7],by=list(site=Whitecourt.o$Site,year=Whitecourt.o$year,month=Whitecourt.o$month,day=Whitecourt.o$day),FUN=min)
Whitecourt.temp.month.min <- arrange(aggregate(Whitecourt.temp.day.min[,5],by=list(site=Whitecourt.temp.day.min$site,year=Whitecourt.temp.day.min$year,month=Whitecourt.temp.day.min$month),FUN=mean),year,month)
Whitecourt.temp.day.max <- aggregate(Whitecourt.o[,7],by=list(site=Whitecourt.o$Site,year=Whitecourt.o$year,month=Whitecourt.o$month,day=Whitecourt.o$day),FUN=max)
Whitecourt.temp.month.max <- arrange(aggregate(Whitecourt.temp.day.max[,5],by=list(site=Whitecourt.temp.day.max$site,year=Whitecourt.temp.day.max$year,month=Whitecourt.temp.day.max$month),FUN=mean),year,month)
Whitecourt.temp.month.mean <- arrange(aggregate(Whitecourt.o[,7],by=list(site=Whitecourt.o$Site,year=Whitecourt.o$year,month=Whitecourt.o$month),FUN=mean),year,month)
Whitecourt.temp.month <- cbind.data.frame(Whitecourt.temp.month.mean,Whitecourt.temp.month.min$x,Whitecourt.temp.month.max$x)
Whitecourt <- cbind.data.frame(Whitecourt.temp.month,Whitecourt.prec.month$x)
names(Whitecourt) <- c("site","year","month","mean","min","max","prec")
site <- rep("Whitecourt",times=9)
year <- as.numeric(c(rep(2016,times=2),rep(2017,times=7)))
month <- as.numeric(c(11:12,1:7))
min <- max <- prec <- mean <- as.numeric(rep(NA,times=9))
Whitecourt.month.add <- cbind(site,year,month,mean,min,max,prec)
Whitecourt <- rbind.data.frame(Whitecourt[1:74,],Whitecourt.month.add,Whitecourt[75:nrow(Whitecourt),])
write.csv(Whitecourt,"Whitecourt.csv",sep=",")
```

# data integration
```{r}
dt4 <- rbind.data.frame(cranbrook,duncanlake,highlevel,nakusp,parsnip,pinepass,revelstoke,skimikin,terrace,tetejaune,Wells,Whitecourt)
dt_repaired <- dt4
write.csv(dt_repaired,"repaired.csv",sep=",")
```

# delete useless data
```{r}
rm(list=ls())
dt4 <- read.csv("repaired.csv",header = TRUE)
dt4$year[dt4$year==2010] <- NA
dt4$year[dt4$year==2015] <- NA
dt4$year[dt4$year==2016] <- NA
dt4$year[dt4$year==2017] <- NA
dt4$year[dt4$year==2018] <- NA
dt4$site[dt4$site=="Whitecourt"] <- NA
dt6 <- na.omit(dt4)
dt6 <- dt6[,-1]
dt6 <- arrange(dt6,year,site)
write.csv(dt6,"site_monthly_1.csv",sep=",")
dt5 <- arrange(dt6,month,year,site)
```

# arranging to fit climate NA
```{r}
site_month <- as.data.frame(1:44)
site_month$site <- c("cranbrook","duncanlake","highlevel","nakusp","parsnip","pinepass","revelstoke","skimikin","terrace","tetejaune","Wells")
site_month$year <- c(rep(2011,times=11),rep(2012,times=11),rep(2013,times=11),rep(2014,times=11))
# Tmax
site_month$Tmax01 <- dt5[(dt5$month == 1),6]
site_month$Tmax02 <- dt5[(dt5$month == 2),6]
site_month$Tmax03 <- dt5[(dt5$month == 3),6]
site_month$Tmax04 <- dt5[(dt5$month == 4),6]
site_month$Tmax05 <- dt5[(dt5$month == 5),6]
site_month$Tmax06 <- dt5[(dt5$month == 6),6]
site_month$Tmax07 <- dt5[(dt5$month == 7),6]
site_month$Tmax08 <- dt5[(dt5$month == 8),6]
site_month$Tmax09 <- dt5[(dt5$month == 9),6]
site_month$Tmax10 <- dt5[(dt5$month == 10),6]
site_month$Tmax11 <- dt5[(dt5$month == 11),6]
site_month$Tmax12 <- dt5[(dt5$month == 12),6]
#Tmin
site_month$Tmin01 <- dt5[(dt5$month == 1),5]
site_month$Tmin02 <- dt5[(dt5$month == 2),5]
site_month$Tmin03 <- dt5[(dt5$month == 3),5]
site_month$Tmin04 <- dt5[(dt5$month == 4),5]
site_month$Tmin05 <- dt5[(dt5$month == 5),5]
site_month$Tmin06 <- dt5[(dt5$month == 6),5]
site_month$Tmin07 <- dt5[(dt5$month == 7),5]
site_month$Tmin08 <- dt5[(dt5$month == 8),5]
site_month$Tmin09 <- dt5[(dt5$month == 9),5]
site_month$Tmin10 <- dt5[(dt5$month == 10),5]
site_month$Tmin11 <- dt5[(dt5$month == 11),5]
site_month$Tmin12 <- dt5[(dt5$month == 12),5]
#Taverage
site_month$Tave01 <- dt5[(dt5$month == 1),4]
site_month$Tave02 <- dt5[(dt5$month == 2),4]
site_month$Tave03 <- dt5[(dt5$month == 3),4]
site_month$Tave04 <- dt5[(dt5$month == 4),4]
site_month$Tave05 <- dt5[(dt5$month == 5),4]
site_month$Tave06 <- dt5[(dt5$month == 6),4]
site_month$Tave07 <- dt5[(dt5$month == 7),4]
site_month$Tave08 <- dt5[(dt5$month == 8),4]
site_month$Tave09 <- dt5[(dt5$month == 9),4]
site_month$Tave10 <- dt5[(dt5$month == 10),4]
site_month$Tave11 <- dt5[(dt5$month == 11),4]
site_month$Tave12 <- dt5[(dt5$month == 12),4]
#prec
site_month$PPT01 <- dt5[(dt5$month == 1),7]
site_month$PPT02 <- dt5[(dt5$month == 2),7]
site_month$PPT03 <- dt5[(dt5$month == 3),7]
site_month$PPT04 <- dt5[(dt5$month == 4),7]
site_month$PPT05 <- dt5[(dt5$month == 5),7]
site_month$PPT06 <- dt5[(dt5$month == 6),7]
site_month$PPT07 <- dt5[(dt5$month == 7),7]
site_month$PPT08 <- dt5[(dt5$month == 8),7]
site_month$PPT09 <- dt5[(dt5$month == 9),7]
site_month$PPT10 <- dt5[(dt5$month == 10),7]
site_month$PPT11 <- dt5[(dt5$month == 11),7]
site_month$PPT12 <- dt5[(dt5$month == 12),7]

#install.packages("myFunctions")
#quadComb()
#install.packages("ggplot2")
```

# comparison in monthly data
```{r}
model_month <- read.csv("import_2011-2014MSY_monthly.csv",header = TRUE, sep = ",") # From ClimateNA
site_month <- site_month[,-1]

#please check site_month's column

# Define function (just for testing)
monthf2 <- function(x,y){
par(mfrow=c(2,3),mai=c(0.3,0.3,0.3,0.3))
sglFit(as.vector(as.matrix(model_month[model_month$site == y,c(3:14)])),as.vector(as.matrix(site_month[site_month$site == x,c(3:14)])),order=1, ylab="Observed", xlab="Predicted",xlim=c(-5,25),ylim=c(-5,25),main=paste(x,"Tmax (°C)"))
sglFit(as.vector(as.matrix(model_month[model_month$site == y,c(15:26)])),as.vector(as.matrix(site_month[site_month$site == x,c(15:26)])),order=1, ylab="Observed", xlab="Predicted",xlim=c(-10,15),ylim=c(-10,15),main=paste(x,"Tmin (°C)"))
sglFit(as.vector(as.matrix(model_month[model_month$site == y,c(27:38)])),as.vector(as.matrix(site_month[site_month$site == x,c(27:38)])),order=1, ylab="Observed", xlab="Predicted",xlim=c(-10,20),ylim=c(-10,20),main=paste(x,"Tave (°C)"))
sglFit(as.vector(as.matrix(model_month[model_month$site == y,c(39:50)])),as.vector(as.matrix(site_month[site_month$site == x,c(39:50)])),order=1, ylab="Observed", xlab="Predicted",main=paste(x,"PPT (mm)"),xlim=c(0,250),ylim=c(0,250))
abline(b=1,a=0,lty=2)
par(mfrow=c(1,1))
}

monthf <- function(x,y){
par(mfrow=c(2,3),mai=c(0.3,0.3,0.3,0.3))
sglFit(as.vector(as.matrix(site_month[site_month$site == x,c(3:14)])),as.vector(as.matrix(model_month[model_month$site == y,c(3:14)])),order=1, xlab="Observed", ylab="Predicted",xlim=c(-5,25),ylim=c(-5,25),main=paste(x,"Tmax (°C)"))
sglFit(as.vector(as.matrix(site_month[site_month$site == x,c(15:26)])),as.vector(as.matrix(model_month[model_month$site == y,c(15:26)])),order=1, xlab="Observed", ylab="Predicted",xlim=c(-10,15),ylim=c(-10,15),main=paste(x,"Tmin (°C)"))
sglFit(as.vector(as.matrix(site_month[site_month$site == x,c(27:38)])),as.vector(as.matrix(model_month[model_month$site == y,c(27:38)])),order=1, xlab="Observed", ylab="Predicted",xlim=c(-10,20),ylim=c(-10,20),main=paste(x,"Tave (°C)"))
sglFit(as.vector(as.matrix(site_month[site_month$site == x,c(39:50)])),as.vector(as.matrix(model_month[model_month$site == y,c(39:50)])),order=1, xlab="Observed", ylab="Predicted",main=paste(x,"PPT (mm)"),xlim=c(0,250),ylim=c(0,250))
abline(b=1,a=0,lty=2)
par(mfrow=c(1,1))
}
#monthf("site name","model name")
### trick alert
#

#overall graph (just testing)
par(mfrow=c(2,2),mai=c(0.7,0.8,0.5,0.8))
sglFit(as.vector(as.matrix(site_month[,c(3:14)])),as.vector(as.matrix(model_month[,c(3:14)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,xlim=c(-20,30),ylim=c(-20,30),main="Tmax (°C)")
sglFit(as.vector(as.matrix(site_month[,c(15:26)])),as.vector(as.matrix(model_month[,c(15:26)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,xlim=c(-35,15),ylim=c(-35,15),main="Tmin (°C)")
sglFit(as.vector(as.matrix(site_month[,c(27:38)])),as.vector(as.matrix(model_month[,c(27:38)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,xlim=c(-30,25),ylim=c(-30,25),main="Tave (°C)")
sglFit(as.vector(as.matrix(site_month[,c(39:50)])),as.vector(as.matrix(model_month[,c(39:50)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,main="PPT (mm)")
abline(b=1,a=0,lty=2)
par(mfrow=c(1,1))

par(mfrow=c(2,2),mai=c(0.7,0.8,0.5,0.8))
plot(as.vector(as.matrix(site_month[,c(3:14)])),as.vector(as.matrix(model_month[,c(3:14)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,xlim=c(-20,30),ylim=c(-20,30),main="Tmax (°C)")
sglFit(as.vector(as.matrix(site_month[,c(15:26)])),as.vector(as.matrix(model_month[,c(15:26)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,xlim=c(-35,15),ylim=c(-35,15),main="Tmin (°C)")
sglFit(as.vector(as.matrix(site_month[,c(27:38)])),as.vector(as.matrix(model_month[,c(27:38)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,xlim=c(-30,25),ylim=c(-30,25),main="Tave (°C)")
sglFit(as.vector(as.matrix(site_month[,c(39:50)])),as.vector(as.matrix(model_month[,c(39:50)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,main="PPT (mm)")
abline(b=1,a=0,lty=2)
par(mfrow=c(1,1))

sglFit(as.vector(as.matrix(site_month[site_month$site == "cranbrook",c(27:38)])),as.vector(as.matrix(model_month[model_month$site == "Cran",c(27:38)])),order=1, xlab="Observed", ylab="Predicted",xlim=c(-10,20),ylim=c(-10,20),main=paste("cranbrook","Tave (°C)"))

#site graphs
monthf("cranbrook","Cran")
monthf("duncanlake","Dunc")
monthf("highlevel","High")
monthf("nakusp","Naku")
monthf("parsnip","Pars")
monthf("pinepass","Pine")
monthf("revelstoke","Reve")
monthf("skimikin","Skim")
monthf("terrace","Terr")
monthf("tetejaune","Tete")
monthf("Wells","Well")

monthp <- function(x,y){
sglFit(as.vector(as.matrix(site_month[site_month$site == x,c(39:50)])),as.vector(as.matrix(model_month[model_month$site == y,c(39:50)])),order=1, xlab="Observed", ylab="Predicted",xlim=c(0,250),ylim=c(0,250),main=paste(x,"PPT (mm)"))
abline(b=1,a=0,lty=2)
}

monthp("cranbrook","Cran")
monthp("duncanlake","Dunc")
monthp("highlevel","High")
monthp("nakusp","Naku")
monthp("parsnip","Pars")
monthp("pinepass","Pine")
monthp("revelstoke","Reve")
monthp("skimikin","Skim")
monthp("terrace","Terr")
monthp("tetejaune","Tete")
monthp("Wells","Well")
```

# aggregate into annual data (for building response variables)
```{r}

########precipitation

prec.year <- arrange(aggregate(dt6[,7],by=list(site=dt6$site,year=dt6$year),FUN=sum),year,site)

########temperature

temp.month.min <- arrange(dt6[,c(1,2,3,5)],site,year,month)
temp.month.max <- arrange(dt6[,c(1,2,3,6)],site,year,month)
temp.month.mean <- arrange(dt6[,c(1,2,3,4)],site,year,month)


temp.year.mean <- aggregate(temp.month.mean[,4],by=list(site=temp.month.mean$site,year=temp.month.mean$year),FUN=mean)#MAT

#Warmest or coolest month of the year
temp.min.month <- aggregate(temp.month.mean[,4],by=list(site=temp.month.mean$site,year=temp.month.mean$year),FUN=min)#MCMT
temp.max.month <- aggregate(temp.month.mean[,4],by=list(site=temp.month.mean$site,year=temp.month.mean$year),FUN=max)#MWMT

climate_year <- arrange(cbind.data.frame(temp.year.mean,temp.min.month$x,temp.max.month$x,prec.year$x),year,site) 

names(climate_year) <- c("site","year","MAT","MCMT","MWMT","MAP")  
climate_year$AHM <- (climate_year$MAT+10)/(climate_year$MAP/1000) #variables_year
write.csv(climate_year,"site_annual.csv",sep=",")

site_year <- climate_year

temp.min.month_bar <- aggregate(temp.min.month[,3],by=list(site=temp.min.month$site),FUN=mean) #MCMT_site
temp.max.month_bar <- aggregate(temp.max.month[,3],by=list(site=temp.max.month$site),FUN=mean) #MWMT_site
temp.year.mean_bar <- aggregate(temp.year.mean[,3],by=list(site=temp.year.mean$site),FUN=mean) #MAT_site

```

# comparison in annual data (derived variables, deleted) 
```{r}
model_year <- read.csv("import_2011-2014MSY_annual.csv",header = TRUE, sep = ",") #Data from ClimateNA

plot(model_year$MAT ~ site_year$MAT,ylab="Model", xlab="Site", main="MAT")
abline(a=0,b=1,col="red")
plot(model_year$MCMT ~ site_year$MCMT,ylab="Model", xlab="Site", main="MCMT")
abline(a=0,b=1,col="red")
plot(model_year$MWMT ~ site_year$MWMT,ylab="Model", xlab="Site", main="MWMT")
abline(a=0,b=1,col="red")
plot(model_year$MAP ~ site_year$MAP,ylab="Model", xlab="Site", main="MAP")
abline(a=0,b=1,col="red")
plot(model_year$AHM ~ site_year$AHM,ylab="Model", xlab="Site", main="AHM", xlim=c(0,30),ylim=c(0,30))
abline(a=0,b=1,col="red")
#Predicted
#Observed
par(mfrow=c(2,3))
sglFit(model_year$MAT,site_year$MAT,order=1,xlab="Observed", ylab="Predicted", main="MAT (°C)")
sglFit(model_year$MCMT,site_year$MCMT,order=1,xlab="Observed", ylab="Predicted", main="MCMT (°C)")
sglFit(model_year$MWMT,site_year$MWMT,order=1,xlab="Observed", ylab="Predicted", main="MWMT (°C)")
sglFit(model_year$MAP,site_year$MAP,order=1,xlab="Observed", ylab="Predicted", main="MAP (mm)")
sglFit(model_year$AHM[c(1:23,25:44)],site_year$AHM[c(1:23,25:44)],order=1,xlab="Observed", ylab="Predicted", main="AHM (°C/mm)")

par(mfrow=c(2,2),mai=c(0.4,0.3,0.4,0.3))
sglFit(model_year$MAT,site_year$MAT,order=1,xlab="Observed", ylab="Predicted", xlim=c(-2,10),ylim=c(-2,10), main="MAT (°C)")
sglFit(model_year$MCMT,site_year$MCMT,order=1,xlab="Observed", ylab="Predicted",xlim=c(-25,0),ylim=c(-25,0), main="MCMT (°C)")
sglFit(model_year$MWMT,site_year$MWMT,order=1,xlab="Observed", ylab="Predicted", xlim=c(10,22),ylim=c(10,22), main="MWMT (°C)")

par(mfrow=c(1,2),mai=c(1.2,0.4,1.0,0.4))
sglFit(model_year$MAP,site_year$MAP,order=1,xlim=c(0,1600),ylim=c(0,1600),xlab="Observed", ylab="Predicted", main="MAP (mm)")
abline(b=1,a=0,lty=2)
sglFit(model_year$AHM[c(1:23,25:44)],site_year$AHM[c(1:23,25:44)],order=1,xlim=c(10,50),ylim=c(10,50),xlab="Observed", ylab="Predicted", main="AHM (°C/mm)")
abline(b=1,a=0,lty=2)
```
# Part 2 Comparison in terms of tree growth and survival
```{r}
# integrate to 2011 - 2014 scale (make onsite observation table the same format as ClimateNA prediction table)
## site (site_1)
site_1 <- as.data.frame(1:11)
site_1$site <- c("cranbrook","duncanlake","highlevel","nakusp","parsnip","pinepass","revelstoke","skimikin","terrace","tetejaune","Wells")
site_1$MAT <- aggregate(site_year[,3],by=list(site=site_year$site),FUN=mean)[,2]
site_1$MCMT <- aggregate(site_year[,4],by=list(site=site_year$site),FUN=mean)[,2]
site_1$MWMT <- aggregate(site_year[,5],by=list(site=site_year$site),FUN=mean)[,2]
site_1$MAP <- aggregate(site_year[,6],by=list(site=site_year$site),FUN=mean)[,2]
site_1$AHM <- (site_1$MAT+10)/(site_1$MAP/1000)
site_1$T1 <- aggregate(site_month[,27],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T2 <- aggregate(site_month[,28],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T3 <- aggregate(site_month[,29],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T4 <- aggregate(site_month[,30],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T5 <- aggregate(site_month[,31],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T6 <- aggregate(site_month[,32],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T7 <- aggregate(site_month[,33],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T8 <- aggregate(site_month[,34],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T9 <- aggregate(site_month[,35],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T10 <- aggregate(site_month[,36],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T11 <- aggregate(site_month[,37],by=list(site=site_month$site),FUN=mean)[,2]
site_1$T12 <- aggregate(site_month[,38],by=list(site=site_month$site),FUN=mean)[,2]

site_1$P1 <- aggregate(site_month[,39],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P2 <- aggregate(site_month[,40],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P3 <- aggregate(site_month[,41],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P4 <- aggregate(site_month[,42],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P5 <- aggregate(site_month[,43],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P6 <- aggregate(site_month[,44],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P7 <- aggregate(site_month[,45],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P8 <- aggregate(site_month[,46],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P9 <- aggregate(site_month[,47],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P10 <- aggregate(site_month[,48],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P11 <- aggregate(site_month[,49],by=list(site=site_month$site),FUN=mean)[,2]
site_1$P12 <- aggregate(site_month[,50],by=list(site=site_month$site),FUN=mean)[,2]

### site_1$AHM <- aggregate(site_year[,7],by=list(site=site_year$site),FUN=mean)[,2]
site_1 <- site_1[,-1]
### site_1[12,6] <- 999999 # it's infinite

## model (model_1)
model_1 <- as.data.frame(1:11)
model_1$site <- c("cranbrook","duncanlake","highlevel","nakusp","parsnip","pinepass","revelstoke","skimikin","terrace","tetejaune","Wells")
model_1$MAT <- aggregate(model_year[,3],by=list(site=model_year$site),FUN=mean)[,2]
model_1$MCMT <- aggregate(model_year[,4],by=list(site=model_year$site),FUN=mean)[,2]
model_1$MWMT <- aggregate(model_year[,5],by=list(site=model_year$site),FUN=mean)[,2]
model_1$MAP <- aggregate(model_year[,6],by=list(site=model_year$site),FUN=mean)[,2]
model_1$AHM <- (model_1$MAT+10)/(model_1$MAP/1000)
model_1$T1 <- aggregate(model_month[,27],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T2 <- aggregate(model_month[,28],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T3 <- aggregate(model_month[,29],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T4 <- aggregate(model_month[,30],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T5 <- aggregate(model_month[,31],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T6 <- aggregate(model_month[,32],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T7 <- aggregate(model_month[,33],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T8 <- aggregate(model_month[,34],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T9 <- aggregate(model_month[,35],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T10 <- aggregate(model_month[,36],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T11 <- aggregate(model_month[,37],by=list(site=model_month$site),FUN=mean)[,2]
model_1$T12 <- aggregate(model_month[,38],by=list(site=model_month$site),FUN=mean)[,2]

model_1$P1 <- aggregate(model_month[,39],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P2 <- aggregate(model_month[,40],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P3 <- aggregate(model_month[,41],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P4 <- aggregate(model_month[,42],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P5 <- aggregate(model_month[,43],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P6 <- aggregate(model_month[,44],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P7 <- aggregate(model_month[,45],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P8 <- aggregate(model_month[,46],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P9 <- aggregate(model_month[,47],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P10 <- aggregate(model_month[,48],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P11 <- aggregate(model_month[,49],by=list(site=model_month$site),FUN=mean)[,2]
model_1$P12 <- aggregate(model_month[,50],by=list(site=model_month$site),FUN=mean)[,2]
### model_1$AHM <-aggregate(model_year[,7],by=list(site=model_year$site),FUN=mean)[,2]
model_1 <- model_1[,-1]
### model_1[12,6] <- 999999 # it's infinite


model_1$T1.2 <- model_1$T1+model_1$T2
model_1$T2.3 <- model_1$T2+model_1$T3
model_1$T3.4 <- model_1$T3+model_1$T4
model_1$T4.5 <- model_1$T4+model_1$T5
model_1$T5.6 <- model_1$T5+model_1$T6
model_1$T6.7 <- model_1$T6+model_1$T7
model_1$T7.8 <- model_1$T7+model_1$T8
model_1$T8.9 <- model_1$T8+model_1$T9
model_1$T9.10 <- model_1$T9+model_1$T10
model_1$T10.11 <- model_1$T10+model_1$T11
model_1$T11.12 <- model_1$T11+model_1$T12
model_1$T12.1 <- model_1$T12+model_1$T1

model_1$P1.2.3 <- model_1$P1+model_1$P2+model_1$P3
model_1$P2.3.4 <- model_1$P2+model_1$P3+model_1$P4
model_1$P3.4.5 <- model_1$P3+model_1$P4+model_1$P5
model_1$P4.5.6 <- model_1$P4+model_1$P5+model_1$P6
model_1$P5.6.7 <- model_1$P5+model_1$P6+model_1$P7
model_1$P6.7.8 <- model_1$P6+model_1$P7+model_1$P8
model_1$P7.8.9 <- model_1$P7+model_1$P8+model_1$P9
model_1$P8.9.10 <- model_1$P8+model_1$P9+model_1$P10
model_1$P9.10.11 <- model_1$P9+model_1$P10+model_1$P11
model_1$P10.11.12 <- model_1$P10+model_1$P11+model_1$P12
model_1$P11.12.1 <- model_1$P11+model_1$P12+model_1$P1
model_1$P12.1.2 <- model_1$P12+model_1$P1+model_1$P2

model_1$T1.2.3 <- model_1$T1+model_1$T2+model_1$T3
model_1$T2.3.4 <- model_1$T2+model_1$T3+model_1$T4
model_1$T3.4.5 <- model_1$T3+model_1$T4+model_1$T5
model_1$T4.5.6 <- model_1$T4+model_1$T5+model_1$T6
model_1$T5.6.7 <- model_1$T5+model_1$T6+model_1$T7
model_1$T6.7.8 <- model_1$T6+model_1$T7+model_1$T8
model_1$T7.8.9 <- model_1$T7+model_1$T8+model_1$T9
model_1$T8.9.10 <- model_1$T8+model_1$T9+model_1$T10
model_1$T9.10.11 <- model_1$T9+model_1$T10+model_1$T11
model_1$T10.11.12 <- model_1$T10+model_1$T11+model_1$T12
model_1$T11.12.1 <- model_1$T11+model_1$T12+model_1$T1
model_1$T12.1.2 <- model_1$T12+model_1$T1+model_1$T2

model_1$P1.2 <- model_1$P1+model_1$P2
model_1$P2.3 <- model_1$P2+model_1$P3
model_1$P3.4 <- model_1$P3+model_1$P4
model_1$P4.5 <- model_1$P4+model_1$P5
model_1$P5.6 <- model_1$P5+model_1$P6
model_1$P6.7 <- model_1$P6+model_1$P7
model_1$P7.8 <- model_1$P7+model_1$P8
model_1$P8.9 <- model_1$P8+model_1$P9
model_1$P9.10 <- model_1$P9+model_1$P10
model_1$P10.11 <- model_1$P10+model_1$P11
model_1$P11.12 <- model_1$P11+model_1$P12
model_1$P12.1 <- model_1$P12+model_1$P1

model_1$Psp <- model_1$P3+model_1$P4+model_1$P5
model_1$Psu <- model_1$P6+model_1$P7+model_1$P8
model_1$Pfa <- model_1$P9+model_1$P10+model_1$P11
model_1$Pwi <- model_1$P12+model_1$P1+model_1$P2

model_1$Tsp <- (model_1$T3+model_1$T4+model_1$T5)/3
model_1$Tsu <- (model_1$T6+model_1$T7+model_1$T8)/3
model_1$Tfa <- (model_1$T9+model_1$T10+model_1$T11)/3
model_1$Twi <- (model_1$T12+model_1$T1+model_1$T2)/3


model_1$MSP <- model_1$P5+model_1$P6+model_1$P7+model_1$P8+model_1$P9
site_1$MSP <- site_1$P5+site_1$P6+site_1$P7+site_1$P8+site_1$P9

site_1$P1.2 <- site_1$P1+site_1$P2
site_1$P2.3 <- site_1$P2+site_1$P3
site_1$P3.4 <- site_1$P3+site_1$P4
site_1$P4.5 <- site_1$P4+site_1$P5
site_1$P5.6 <- site_1$P5+site_1$P6
site_1$P6.7 <- site_1$P6+site_1$P7
site_1$P7.8 <- site_1$P7+site_1$P8
site_1$P8.9 <- site_1$P8+site_1$P9
site_1$P9.10 <- site_1$P9+site_1$P10
site_1$P10.11 <- site_1$P10+site_1$P11
site_1$P11.12 <- site_1$P11+site_1$P12
site_1$P12.1 <- site_1$P12+site_1$P1

site_1$P1.2.3 <- site_1$P1+site_1$P2+site_1$P3
site_1$P2.3.4 <- site_1$P2+site_1$P3+site_1$P4
site_1$P3.4.5 <- site_1$P3+site_1$P4+site_1$P5
site_1$P4.5.6 <- site_1$P4+site_1$P5+site_1$P6
site_1$P5.6.7 <- site_1$P5+site_1$P6+site_1$P7
site_1$P6.7.8 <- site_1$P6+site_1$P7+site_1$P8
site_1$P7.8.9 <- site_1$P7+site_1$P8+site_1$P9
site_1$P8.9.10 <- site_1$P8+site_1$P9+site_1$P10
site_1$P9.10.11 <- site_1$P9+site_1$P10+site_1$P11
site_1$P10.11.12 <- site_1$P10+site_1$P11+site_1$P12
site_1$P11.12.1 <- site_1$P11+site_1$P12+site_1$P1
site_1$P12.1.2 <- site_1$P12+site_1$P1+site_1$P2

site_1$T1.2.3 <- site_1$T1+site_1$T2+site_1$T3
site_1$T2.3.4 <- site_1$T2+site_1$T3+site_1$T4
site_1$T3.4.5 <- site_1$T3+site_1$T4+site_1$T5
site_1$T4.5.6 <- site_1$T4+site_1$T5+site_1$T6
site_1$T5.6.7 <- site_1$T5+site_1$T6+site_1$T7
site_1$T6.7.8 <- site_1$T6+site_1$T7+site_1$T8
site_1$T7.8.9 <- site_1$T7+site_1$T8+site_1$T9
site_1$T8.9.10 <- site_1$T8+site_1$T9+site_1$T10
site_1$T9.10.11 <- site_1$T9+site_1$T10+site_1$T11
site_1$T10.11.12 <- site_1$T10+site_1$T11+site_1$T12
site_1$T11.12.1 <- site_1$T11+site_1$T12+site_1$T1
site_1$T12.1.2 <- site_1$T12+site_1$T1+site_1$T2

site_1$T1.2 <- site_1$T1+site_1$T2
site_1$T2.3 <- site_1$T2+site_1$T3
site_1$T3.4 <- (site_1$T3+site_1$T4)/2
site_1$T4.5 <- site_1$T4+site_1$T5
site_1$T5.6 <- site_1$T5+site_1$T6
site_1$T6.7 <- site_1$T6+site_1$T7
site_1$T7.8 <- site_1$T7+site_1$T8
site_1$T8.9 <- site_1$T8+site_1$T9
site_1$T9.10 <- site_1$T9+site_1$T10
site_1$T10.11 <- site_1$T10+site_1$T11
site_1$T11.12 <- site_1$T11+site_1$T12
site_1$T12.1 <- site_1$T12+site_1$T1

site_1$Psp <- site_1$P3+site_1$P4+site_1$P5
site_1$Psu <- site_1$P6+site_1$P7+site_1$P8
site_1$Pfa <- site_1$P9+site_1$P10+site_1$P11
site_1$Pwi <- site_1$P12+site_1$P1+site_1$P2

site_1$Tsp <- (site_1$T3+site_1$T4+site_1$T5)/3
site_1$Tsu <- (site_1$T6+site_1$T7+site_1$T8)/3
site_1$Tfa <- (site_1$T9+site_1$T10+site_1$T11)/3
site_1$Twi <- (site_1$T12+site_1$T1+site_1$T2)/3

model_1$T1.2.3 <- model_1$T1+model_1$T2+model_1$T3

site_2$T8.9.10 <- site_2$T8+site_2$T9+site_2$T10

####################################################################################################

model_2 <- model_1[,-1]
site_2 <- site_1[,-1]
data_2 <- data_1[,-1]
#install.packages("RSA")
quadComb(model_2,vege_bar2$Height_change,nComb = 1,nVar = 10)
require(CEMT)
fWrite()
fit1 <- quadComb(model_2,vege_bar2$Height_change,nComb = 1,nVar = 10)        
a <- fit1$list
fit2 <- quadComb(site_2,vege_bar2$Height_change,nComb = 1,nVar = 10)        
b <- fit2$list
fit3 <- quadComb(data_2,vege_bar2$Height_change,nComb = 1,nVar = 10)        
c <- fit3$list
# a in console
fit4 <- quadComb(model_2,vege_bar2$rate,nComb = 1,nVar = 10)
d <- fit4$list
fit5<- quadComb(site_2,vege_bar2$rate,nComb = 1,nVar = 10)    
e <- fit5$list
fit6<- quadComb(data_2,vege_bar2$rate,nComb = 1,nVar = 10)    
f <- fit6$list


####### prov 348
fit1 <- quadComb(model_2,v348$Height_change,nComb = 1,nVar = 10)        
fit2 <- quadComb(site_2,v348$Height_change,nComb = 1,nVar = 10) 
fit3 <- quadComb(data_2,v348$Height_change,nComb = 1,nVar = 10)   
a348 <- fit1$list
b348 <- fit2$list
c348 <- fit3$list
fit4 <- quadComb(model_2,v348$rate,nComb = 1,nVar = 10)        
fit5 <- quadComb(site_2,v348$rate,nComb = 1,nVar = 10)
fit6 <- quadComb(data_2,v348$rate,nComb = 1,nVar = 10)   
d348 <- fit4$list
e348 <- fit5$list
f348 <- fit6$list


####### prov 405
fit1 <- quadComb(model_2,v405$Height_change,nComb = 1,nVar = 10)        
fit2 <- quadComb(site_2,v405$Height_change,nComb = 1,nVar = 10) 
fit3 <- quadComb(data_2,v405$Height_change,nComb = 1,nVar = 10)   
a405 <- fit1$list
b405 <- fit2$list
c405 <- fit3$list
fit4 <- quadComb(model_2,v405$rate,nComb = 1,nVar = 10)        
fit5 <- quadComb(site_2,v405$rate,nComb = 1,nVar = 10)
fit6 <- quadComb(data_2,v405$rate,nComb = 1,nVar = 10)   
d405 <- fit4$list
e405 <- fit5$list
f405 <- fit6$list

####### prov 406
fit1 <- quadComb(model_2,v406$Height_change,nComb = 1,nVar = 10)        
fit2 <- quadComb(site_2,v406$Height_change,nComb = 1,nVar = 10) 
fit3 <- quadComb(data_2,v406$Height_change,nComb = 1,nVar = 10)   
a406 <- fit1$list
b406 <- fit2$list
c406 <- fit3$list
fit4 <- quadComb(model_2,v406$rate,nComb = 1,nVar = 10)        
fit5 <- quadComb(site_2,v406$rate,nComb = 1,nVar = 10)
fit6 <- quadComb(data_2,v406$rate,nComb = 1,nVar = 10)   
d406 <- fit4$list
e406 <- fit5$list
f406 <- fit6$list


# v405
#> b405
#     var1     r2_adj     P-value     sgma      aic
#1      T9  0.6668000 0.005046129 17.46426  98.6371


#> d405
#     var1    r2_adj      P-value       sgma         aic
#1      T9  0.892900 5.385391e-05 0.08408465 -18.7568313

# v406
#> a406
#     var1    r2_adj    P-value     sgma      aic
#1    T8.9  0.413500 0.04845040 29.74254 110.3504

#> b406
#     var1     r2_adj    P-value     sgma      aic
#1     P12  0.4459000 0.03860329 28.90972 109.7256
#2    P4.5  0.4114000 0.04915651 29.79638 110.3902

#> c406  *****
#     var1    r2_adj    P-value      sgma         aic
#1    T8.9  0.470100 0.03230623 0.1942896 -0.33126000
#2      T9  0.469100 0.03254049 0.1944652 -0.31139092
#3      T8  0.456200 0.03582432 0.1968163 -0.04700106
#4      P3  0.435200 0.04168458 0.2005791  0.36963564

#> d406
#     var1    r2_adj     P-value      sgma        aic
#1      T9  0.698700 0.003375404 0.1464973 -6.5428093
#2    P3.4  0.582300 0.012466170 0.1724866 -2.9499251
#3      P3  0.526500 0.020597810 0.1836608 -1.5689668
#4    T8.9  0.521700 0.021429570 0.1845719 -1.4601033
#5     Psp  0.483200 0.029214610 0.1918619 -0.6078862
#6      T8  0.436700 0.041238800 0.2003097  0.3400684
#7    MWMT  0.416300 0.047550740 0.2039076  0.7317171

sglFit(model_2$T7.8.9,v406$rate,order=2)
sglFit(site_2$T7.8.9,v406$rate,order=2)

sglFit(model_2$P3.4,vege_bar2$rate,order=2)
sglFit(site_2$P3.4,vege_bar2$rate,order=2)
sglFit(model_2$P3,vege_bar2$rate,order=2)
sglFit(site_2$P3,vege_bar2$rate,order=2)
par(mfrow=c(2,3))
sglFit(model_2$P3.4.5,vege_bar2$rate,order=2,main="Predicted Psp vs. growth", xlab="Predicted Precipitation in Spring (mm)",ylab="height(m)")
sglFit(site_2$P3.4.5,vege_bar2$rate,order=2, main="Observed Psp vs. growth", xlab="Observed Precipitation in Spring (mm)",ylab="height(m)")
sglFit(model_2$MCMT,vege_bar2$rate,order=2,main="predicted MCMT vs. growth", xlab="predicted MCMT(°C)",ylab="height(m)")
sglFit(site_2$MCMT,vege_bar2$rate,order=2,main="observed MCMT vs. growth", xlab="observed MCMT(°C)",ylab="height(m)")

sglFit(model_2$T8.9,v348$rate,order=2)
sglFit(site_2$T8.9,v348$rate,order=2)

sglFit(model_2$T8.9,v348$rate,order=1)
sglFit(site_2$T8.9,v348$rate,order=1)


sglFit(model_2$T8.9,v405$rate,order=2)
sglFit(site_2$T8.9,v405$rate,order=2)

sglFit(model_2$T8.9,v405$rate,order=1)
sglFit(site_2$T8.9,v405$rate,order=1)



####### MCMT
par(mfrow=c(1,2),mai=c(1.2,0.4,1.0,0.4))
sglFit(model_2$MCMT,vege_bar2$rate,order=2,main="Predicted MCMT vs. growth", xlab="predicted MCMT(°C)",ylab="height(m)")
sglFit(site_2$MCMT,vege_bar2$rate,order=2,main="Observed MCMT vs. growth", xlab="observed MCMT(°C)",ylab="height(m)")

sglFit(model_2$MCMT,v348$rate,order=2)
sglFit(site_2$MCMT,v348$rate,order=2)

sglFit(model_2$MCMT,v405$rate,order=2)
sglFit(site_2$MCMT,v405$rate,order=2)

sglFit(model_2$MCMT,v406$rate,order=2)
sglFit(site_2$MCMT,v406$rate,order=2)

#store
model_year_f <- model_year #store
model_f <- model_1
site_f <- site_1

#revised 
par(mfrow=c(2,3),mai=c(0.3,0.3,0.3,0.3))
sglFit(as.vector(as.matrix(site_month[,c(3:14)])),as.vector(as.matrix(model_month[,c(3:14)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,xlim=c(-20,30),ylim=c(-20,30),main="Tmax (°C)")
sglFit(as.vector(as.matrix(site_month[,c(15:26)])),as.vector(as.matrix(model_month[,c(15:26)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,xlim=c(-35,15),ylim=c(-35,15),main="Tmin (°C)")
sglFit(as.vector(as.matrix(site_month[,c(27:38)])),as.vector(as.matrix(model_month[,c(27:38)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,xlim=c(-30,25),ylim=c(-30,25),main="Tave (°C)")
sglFit(as.vector(as.matrix(site_month[,c(39:50)])),as.vector(as.matrix(model_month[,c(39:50)])),order=1, xlab="Observed", ylab="Predicted",cex=1.3,main="PPT (mm)",xlim=c(0,250),ylim=c(0,250))
abline(b=1,a=0,lty=2)
par(mfrow=c(1,1))

for (i in 1:44){
  model_year$MCMT[i] <- min(model_month[i,27:38])
  model_year$MWMT[i] <- max(model_month[i,27:38])
  model_year$MAT[i] <- sum(model_month[i,27:38])/12
}
for (i in 1:44){
  site_year$MCMT[i] <- min(site_month[i,27:38])
  site_year$MWMT[i] <- max(site_month[i,27:38])
  site_year$MAT[i] <- sum(site_month[i,27:38])/12
}
write.csv(model_month,file = "model_month.csv")
write.csv(model_year,file = "model_year.csv")

?write.csv
par(mfrow=c(2,3))
sglFit(model_1$P3.4.5,vege_bar2$rate,order=2,main="Predicted Psp vs. growth", xlab="Predicted Precipitation in Spring (mm)",ylab="height(m)")
sglFit(site_2$P3.4.5,vege_bar2$rate,order=2, main="Observed Psp vs. growth", xlab="Observed Precipitation in Spring (mm)",ylab="height(m)")
sglFit(model_1$MCMT,vege_bar2$rate,order=2,main="predicted MCMT vs. growth", xlab="predicted MCMT(°C)",ylab="height(m)")
sglFit(site_2$MCMT,vege_bar2$rate,order=2,main="observed MCMT vs. growth", xlab="observed MCMT(°C)",ylab="height(m)")

a
b
c
d

a348
b348
c348
d348

par(mfrow=c(2,2),mai=c(0.3,1,0.3,1))
sglFit(model_1$MCMT,v406$rate,order=2,main="predicted MCMT vs. growth rate", xlab="predicted MCMT(°C)",ylab="height change (%)")
sglFit(site_2$MCMT,v406$rate,order=2,main="observed MCMT vs. growth rate", xlab="observed MCMT(°C)",ylab="height change (%)")
sglFit(model_1$Psp,v406$rate,order=2,main="Predicted Psp vs. growth rate", xlab="Predicted Precipitation in Spring (mm)",ylab="height change (%)")
sglFit(site_2$Psp,v406$rate,order=2, main="Observed Psp vs. growth rate", xlab="Observed Precipitation in Spring (mm)",ylab="height change (%)")


a405
b405
c405
d405

par(mfrow=c(2,2),mai=c(0.3,1,0.3,1))
sglFit(model_1$MCMT,v405$rate,order=2,main="predicted MCMT vs. growth rate", xlab="predicted MCMT(°C)",ylab="height change (%)")
sglFit(site_2$MCMT,v405$rate,order=2,main="observed MCMT vs. growth rate", xlab="observed MCMT(°C)",ylab="height change (%)")
sglFit(model_1$P4.5.6,v405$rate,order=2,main="Predicted P4.5.6 vs. growth rate", xlab="Predicted Precipitation in April, May, and June (mm)",ylab="height change (%)")
sglFit(site_2$P4.5.6,v405$rate,order=2, main="Observed P4.5.6 vs. growth rate", xlab="Observed Precipitation in April, May, and June (mm)",ylab="height change (%)")


a406
b406
c406
d406
par(mfrow=c(2,2),mai=c(0.3,1,0.3,1))
sglFit(model_1$MCMT,v406$rate,order=2,main="predicted MCMT vs. growth rate", xlab="predicted MCMT(°C)",ylab="height change (%)")
sglFit(site_2$MCMT,v406$rate,order=2,main="observed MCMT vs. growth rate", xlab="observed MCMT(°C)",ylab="height change (%)")
par(mfrow=c(2,2),mai=c(0.3,1,0.3,1))
sglFit(model_1$Psp,v406$rate,order=2,main="Predicted P3.4 vs. growth rate", xlab="Predicted Precipitation in March and April (mm)",ylab="height change (%)")
sglFit(site_2$P3,v406$rate,order=2, main="Observed P3.4 vs. growth rate", xlab="Observed Precipitation in March and April (mm)",ylab="height change (%)")

```
# v348 
> c348
        var1    r2_adj    P-value      sgma      aic
1         P3  0.336900 0.07917514 0.2008008 0.393936

> d348
        var1    r2_adj    P-value      sgma        aic
1         T9  0.535300 0.01909904 0.1681002 -3.5166307
2       P3.4  0.456000 0.03586502 0.1818762 -1.7837883
3         P3  0.388100 0.05741627 0.1928951 -0.4897341
4        Psp  0.366800 0.06585450 0.1962298 -0.1126541
5     P3.4.5  0.366800 0.06585450 0.1962298 -0.1126541
6     P2.3.4  0.350400 0.07295235 0.1987567  0.1688324
7       MWMT  0.333600 0.08075725 0.2012980  0.4483460
8       T8.9  0.300800 0.09792151 0.2062062  0.9783217

# v405
> c405
        var1    r2_adj   P-value      sgma      aic
1       MCMT  0.250400 0.1293563 0.2224785 2.649308
2     P4.5.6  0.240100 0.1366052 0.2240000 2.799251
> d405
        var1    r2_adj      P-value       sgma         aic
1         T9  0.892900 5.385391e-05 0.08408465 -18.7568313
2    T8.9.10  0.593900 1.113942e-02 0.16374663  -4.0939130

# v406
> c406
        var1    r2_adj    P-value      sgma         aic
1       T8.9  0.470100 0.03230623 0.1942896 -0.33126000
2         T9  0.469100 0.03254049 0.1944652 -0.31139092
3    T8.9.10  0.468700 0.03264626 0.1945441 -0.30246751
4         T8  0.456200 0.03582432 0.1968163 -0.04700106
5         P3  0.435200 0.04168458 0.2005791  0.36963564
6     T7.8.9  0.424200 0.04501620 0.2025163  0.58108620
7         P6  0.402100 0.05234980 0.2063732  0.99613173
8       MWMT  0.400400 0.05294335 0.2066642  1.02713659
9       T7.8  0.391500 0.05616146 0.2081942  1.18940912

> d406
        var1    r2_adj     P-value      sgma        aic
1         T9  0.698700 0.003375404 0.1464973 -6.5428093
2       P3.4  0.582300 0.012466170 0.1724866 -2.9499251
3         P3  0.526500 0.020597810 0.1836608 -1.5689668
4       T8.9  0.521700 0.021429570 0.1845719 -1.4601033
5     T7.8.9  0.484400 0.028950230 0.1916440 -0.6328854
6        Psp  0.483200 0.029214610 0.1918619 -0.6078862
7     P3.4.5  0.483200 0.029214610 0.1918619 -0.6078862
8         T8  0.436700 0.041238800 0.2003097  0.3400684
9     P2.3.4  0.427900 0.043866000 0.2018621  0.5099086
10      MWMT  0.416300 0.047550740 0.2039076  0.7317171
11   T8.9.10  0.411600 0.049112210 0.2047328  0.8205708

# test Env Can Weather station
```{r}
# Terrace
T2011 <- read.csv("en_climate_daily_BC_1068130_2011_P1D.csv")[,c(6,7,8,10,12,14,20)]
T2012 <- read.csv("en_climate_daily_BC_1068130_2012_P1D.csv")[,c(6,7,8,10,12,14,20)]
Terr3 <- read.csv("en_climate_daily_BC_1068130_2013_P1D.csv")[1:16,c(6,7,8,10,12,14,20)]
Terr4 <- read.csv("en_climate_daily_BC_1068134_2013_P1D.csv")[-(1:16),c(6,7,8,10,12,14,20)]
T2013 <- rbind.data.frame(Terr3,Terr4)
T2014 <- read.csv("en_climate_daily_BC_1068134_2014_P1D.csv")[,c(6,7,8,10,12,14,20)]
Te <- rbind.data.frame(T2011,T2012,T2013,T2014)
Te <- na.omit(Te)
names(Te) <- c("year","month","day","max.temp","min.temp","mean.temp","prep")
#monthly
Terr_month <- site_month[c(9,20,31,42),] # just a base data frame
month_terr <- arrange(aggregate(Te[,c(4,5,6)],by=list(year=Te$year,month=Te$month),FUN = mean),month,year)
month_terr_p <- arrange(aggregate(Te[,7],by=list(year=Te$year,month=Te$month),FUN = sum),month,year)
test3 <- aggregate(Te[,7],by=list(year=Te$year),FUN = sum)
Terr_month$Tmax01 <- month_terr[which(month_terr$month == 1),3]
Terr_month$Tmax02 <- month_terr[which(month_terr$month == 2),3]
Terr_month$Tmax03 <- month_terr[which(month_terr$month == 3),3]
Terr_month$Tmax04 <- month_terr[which(month_terr$month == 4),3]
Terr_month$Tmax05 <- month_terr[which(month_terr$month == 5),3]
Terr_month$Tmax06 <- month_terr[which(month_terr$month == 6),3]
Terr_month$Tmax07 <- month_terr[which(month_terr$month == 7),3]
Terr_month$Tmax08 <- month_terr[which(month_terr$month == 8),3]
Terr_month$Tmax09 <- month_terr[which(month_terr$month == 9),3]
Terr_month$Tmax10 <- month_terr[which(month_terr$month == 10),3]
Terr_month$Tmax11 <- month_terr[which(month_terr$month == 11),3]
Terr_month$Tmax12 <- month_terr[which(month_terr$month == 12),3]

Terr_month$Tmin01 <- month_terr[which(month_terr$month == 1),4]
Terr_month$Tmin02 <- month_terr[which(month_terr$month == 2),4]
Terr_month$Tmin03 <- month_terr[which(month_terr$month == 3),4]
Terr_month$Tmin04 <- month_terr[which(month_terr$month == 4),4]
Terr_month$Tmin05 <- month_terr[which(month_terr$month == 5),4]
Terr_month$Tmin06 <- month_terr[which(month_terr$month == 6),4]
Terr_month$Tmin07 <- month_terr[which(month_terr$month == 7),4]
Terr_month$Tmin08 <- month_terr[which(month_terr$month == 8),4]
Terr_month$Tmin09 <- month_terr[which(month_terr$month == 9),4]
Terr_month$Tmin10 <- month_terr[which(month_terr$month == 10),4]
Terr_month$Tmin11 <- month_terr[which(month_terr$month == 11),4]
Terr_month$Tmin12 <- month_terr[which(month_terr$month == 12),4]

Terr_month$Tave01 <- month_terr[which(month_terr$month == 1),5]
Terr_month$Tave02 <- month_terr[which(month_terr$month == 2),5]
Terr_month$Tave03 <- month_terr[which(month_terr$month == 3),5]
Terr_month$Tave04 <- month_terr[which(month_terr$month == 4),5]
Terr_month$Tave05 <- month_terr[which(month_terr$month == 5),5]
Terr_month$Tave06 <- month_terr[which(month_terr$month == 6),5]
Terr_month$Tave07 <- month_terr[which(month_terr$month == 7),5]
Terr_month$Tave08 <- month_terr[which(month_terr$month == 8),5]
Terr_month$Tave09 <- month_terr[which(month_terr$month == 9),5]
Terr_month$Tave10 <- month_terr[which(month_terr$month == 10),5]
Terr_month$Tave11 <- month_terr[which(month_terr$month == 11),5]
Terr_month$Tave12 <- month_terr[which(month_terr$month == 12),5]

Terr_month$PPT01 <- month_terr_p[which(month_terr_p$month == 1),3]
Terr_month$PPT02 <- month_terr_p[which(month_terr_p$month == 2),3]
Terr_month$PPT03 <- month_terr_p[which(month_terr_p$month == 3),3]
Terr_month$PPT04 <- month_terr_p[which(month_terr_p$month == 4),3]
Terr_month$PPT05 <- month_terr_p[which(month_terr_p$month == 5),3]
Terr_month$PPT06 <- month_terr_p[which(month_terr_p$month == 6),3]
Terr_month$PPT07 <- month_terr_p[which(month_terr_p$month == 7),3]
Terr_month$PPT08 <- month_terr_p[which(month_terr_p$month == 8),3]
Terr_month$PPT09 <- month_terr_p[which(month_terr_p$month == 9),3]
Terr_month$PPT10 <- month_terr_p[which(month_terr_p$month == 10),3]
Terr_month$PPT11 <- month_terr_p[which(month_terr_p$month == 11),3]
Terr_month$PPT12 <- month_terr_p[which(month_terr_p$month == 12),3]

x <- Terr_month$PPT01
y <- site_month$PPT01[c(9,20,31,42)]
z <- model_month$PPT01[c(9,20,31,42)]
dblFit <- function(x,y,z,plot=T,rmse=F, ...){
	xy <- data.frame(x,y);head(xy)
	xy2 <- na.omit(xy)
	x <- xy2$x; y <- xy2$y
	lm0 <- lm(y~x)
	r2p <- r2pFun(lm0);r2p
	plot(y~x,pch = 21,bg = "gold",...)
		# plot(y,x)
	x0 <- data.frame(x=seq(min(x),max(x),len=100))
	p <- predict(lm0,x0)
	abline(lm0,col='gold4',lwd=2)
	xz <- data.frame(x,z);head(xz)
	xz2 <- na.omit(xz)
	x <- xz2$x; y <- xz2$z
	lm1 <- lm(z~x)
	r2p1 <- r2pFun(lm1);r2p1
	points(z~x,pch = 21,cex = 1.3,bg = "cyan")
	abline(lm1,col='cyan4',lwd=2)
}


png(filename = "Figure_6_monthly_temperature_Env_Can.png",height = 600, width = 1700, res = 170)
par(mfrow=c(1,3), cex.lab=1.25,mai=c(0.55,0.55,0.35,0.1))
dblFit(as.vector(as.matrix(Terr_month[,c(15:26)])),as.vector(as.matrix(site_month[c(9,20,31,42),c(15:26)])),as.vector(as.matrix(model_month[c(9,20,31,42),c(15:26)])),order=1, rmse=T, xlab="",ylab="",cex=1.3,xlim=c(-35,15),ylim=c(-35,15),main="Minimum temperature")
abline(b=1,a=0,lty=2)
dblFit(as.vector(as.matrix(Terr_month[,c(3:14)])),as.vector(as.matrix(site_month[c(9,20,31,42),c(3:14)])),as.vector(as.matrix(model_month[c(9,20,31,42),c(3:14)])),order=1, rmse=T, xlab="",ylab="",cex=1.3,xlim=c(-35,15),ylim=c(-35,15),main="Maximum temperature")
abline(b=1,a=0,lty=2)
dblFit(as.vector(as.matrix(Terr_month[,c(27:38)])),as.vector(as.matrix(site_month[c(9,20,31,42),c(27:38)])),as.vector(as.matrix(model_month[c(9,20,31,42),c(27:38)])),order=1, rmse=T, xlab="",ylab="",cex=1.3,xlim=c(-35,15),ylim=c(-35,15),main="Average temperature")
abline(b=1,a=0,lty=2)
dev.off()


dblFit(as.vector(as.matrix(Terr_month[,c(39:50)])),as.vector(as.matrix(site_month[c(9,20,31,42),c(39:50)])),as.vector(as.matrix(model_month[c(9,20,31,42),c(39:50)])),order=1, rmse=T, xlab="",ylab="",cex=1.3,xlim=c(0,250),ylim=c(0,250),main="Monthly precipitation")
abline(b=1,a=0,lty=2)
#annual
Terr_year <- site_year[c(9,20,31,42),]
Terr_year$MAT <- c(mean(month_terr$mean.temp[which(month_terr$year == 2011)]),mean(month_terr$mean.temp[which(month_terr$year == 2012)]),mean(month_terr$mean.temp[which(month_terr$year == 2013)]),mean(month_terr$mean.temp[which(month_terr$year == 2014)]))
Terr_year$MAP <- c(mean(month_terr_p$x[which(month_terr_p$year == 2011)]),mean(month_terr_p$x[which(month_terr_p$year == 2012)]),mean(month_terr_p$x[which(month_terr_p$year == 2013)]),mean(month_terr_p$x[which(month_terr_p$year == 2014)]))

## Wells 20% missing
W2011 <- read.csv("en_climate_daily_BC_1090660_2011_P1D.csv")[,c(6,7,8,10,12,14,20)]
W2012 <- read.csv("en_climate_daily_BC_1090660_2012_P1D.csv")[,c(6,7,8,10,12,14,20)]
W2013 <- read.csv("en_climate_daily_BC_1090660_2013_P1D.csv")[,c(6,7,8,10,12,14,20)]
W2014 <- read.csv("en_climate_daily_BC_1090660_2014_P1D.csv")[,c(6,7,8,10,12,14,20)]

We <- rbind(W2011,W2012,W2013,W2014)
We <- na.omit(We)
names(We) <- c("year","month","day","max.temp","min.temp","mean.temp","prep")
Well_month <- site_month[c(11,22,33,44),] # just a base data frame
month_well <- arrange(aggregate(We[,c(4,5,6)],by=list(year=We$year,month=We$month),FUN = mean),month,year)
month_well_p <- arrange(aggregate(We[,7],by=list(year=We$year,month=We$month),FUN = sum),month,year)
Well_month$PPT01 <- month_well_p[which(month_well_p$month == 1),3]
Well_month$PPT02 <- month_well_p[which(month_well_p$month == 2),3]
Well_month$PPT03 <- month_well_p[which(month_well_p$month == 3),3]
Well_month$PPT04 <- month_well_p[which(month_well_p$month == 4),3]
Well_month$PPT05 <- month_well_p[which(month_well_p$month == 5),3]
Well_month$PPT06 <- month_well_p[which(month_well_p$month == 6),3]
Well_month$PPT07 <- month_well_p[which(month_well_p$month == 7),3]
Well_month$PPT08 <- month_well_p[which(month_well_p$month == 8),3]
Well_month$PPT09 <- month_well_p[which(month_well_p$month == 9),3]
Well_month$PPT10 <- month_well_p[which(month_well_p$month == 10),3]
Well_month$PPT11 <- month_well_p[which(month_well_p$month == 11),3]
Well_month$PPT12 <- month_well_p[which(month_well_p$month == 12),3]

##Duncan Lake
D2011 <- read.csv("en_climate_daily_BC_1142574_2011_P1D.csv")[,c(6,7,8,10,12,14,20)]
D2012 <- read.csv("en_climate_daily_BC_1142574_2012_P1D.csv")[,c(6,7,8,10,12,14,20)]
D2013 <- read.csv("en_climate_daily_BC_1142574_2013_P1D.csv")[,c(6,7,8,10,12,14,20)]
D2014 <- read.csv("en_climate_daily_BC_1142574_2014_P1D.csv")[,c(6,7,8,10,12,14,20)]
Du <- rbind(D2011,D2012,D2013,D2014)
Du <- na.omit(Du)
names(Du) <- c("year","month","day","max.temp","min.temp","mean.temp","prep")
Dunc_month <- site_month[c(2,13,24,35),]
month_dunc <- arrange(aggregate(Du[,c(4,5,6)],by=list(year=Du$year,month=Du$month),FUN = mean),month,year)
month_dunc_p <- arrange(aggregate(Du[,7],by=list(year=Du$year,month=Du$month),FUN = sum),month,year)
Dunc_month$Tmax01 <- month_dunc[which(month_dunc$month == 1),3]
Dunc_month$Tmax02 <- month_dunc[which(month_dunc$month == 2),3]
Dunc_month$Tmax03 <- month_dunc[which(month_dunc$month == 3),3]
Dunc_month$Tmax04 <- month_dunc[which(month_dunc$month == 4),3]
Dunc_month$Tmax05 <- month_dunc[which(month_dunc$month == 5),3]
Dunc_month$Tmax06 <- month_dunc[which(month_dunc$month == 6),3]
Dunc_month$Tmax07 <- month_dunc[which(month_dunc$month == 7),3]
Dunc_month$Tmax08 <- month_dunc[which(month_dunc$month == 8),3]
Dunc_month$Tmax09 <- month_dunc[which(month_dunc$month == 9),3]
Dunc_month$Tmax10 <- month_dunc[which(month_dunc$month == 10),3]
Dunc_month$Tmax11 <- month_dunc[which(month_dunc$month == 11),3]
Dunc_month$Tmax12 <- month_dunc[which(month_dunc$month == 12),3]

Dunc_month$Tmin01 <- month_dunc[which(month_dunc$month == 1),4]
Dunc_month$Tmin02 <- month_dunc[which(month_dunc$month == 2),4]
Dunc_month$Tmin03 <- month_dunc[which(month_dunc$month == 3),4]
Dunc_month$Tmin04 <- month_dunc[which(month_dunc$month == 4),4]
Dunc_month$Tmin05 <- month_dunc[which(month_dunc$month == 5),4]
Dunc_month$Tmin06 <- month_dunc[which(month_dunc$month == 6),4]
Dunc_month$Tmin07 <- month_dunc[which(month_dunc$month == 7),4]
Dunc_month$Tmin08 <- month_dunc[which(month_dunc$month == 8),4]
Dunc_month$Tmin09 <- month_dunc[which(month_dunc$month == 9),4]
Dunc_month$Tmin10 <- month_dunc[which(month_dunc$month == 10),4]
Dunc_month$Tmin11 <- month_dunc[which(month_dunc$month == 11),4]
Dunc_month$Tmin12 <- month_dunc[which(month_dunc$month == 12),4]

Dunc_month$Tave01 <- month_dunc[which(month_dunc$month == 1),5]
Dunc_month$Tave02 <- month_dunc[which(month_dunc$month == 2),5]
Dunc_month$Tave03 <- month_dunc[which(month_dunc$month == 3),5]
Dunc_month$Tave04 <- month_dunc[which(month_dunc$month == 4),5]
Dunc_month$Tave05 <- month_dunc[which(month_dunc$month == 5),5]
Dunc_month$Tave06 <- month_dunc[which(month_dunc$month == 6),5]
Dunc_month$Tave07 <- month_dunc[which(month_dunc$month == 7),5]
Dunc_month$Tave08 <- month_dunc[which(month_dunc$month == 8),5]
Dunc_month$Tave09 <- month_dunc[which(month_dunc$month == 9),5]
Dunc_month$Tave10 <- month_dunc[which(month_dunc$month == 10),5]
Dunc_month$Tave11 <- month_dunc[which(month_dunc$month == 11),5]
Dunc_month$Tave12 <- month_dunc[which(month_dunc$month == 12),5]

Dunc_month$PPT01 <- month_dunc_p[which(month_dunc_p$month == 1),3]
Dunc_month$PPT02 <- month_dunc_p[which(month_dunc_p$month == 2),3]
Dunc_month$PPT03 <- month_dunc_p[which(month_dunc_p$month == 3),3]
Dunc_month$PPT04 <- month_dunc_p[which(month_dunc_p$month == 4),3]
Dunc_month$PPT05 <- month_dunc_p[which(month_dunc_p$month == 5),3]
Dunc_month$PPT06 <- month_dunc_p[which(month_dunc_p$month == 6),3]
Dunc_month$PPT07 <- month_dunc_p[which(month_dunc_p$month == 7),3]
Dunc_month$PPT08 <- month_dunc_p[which(month_dunc_p$month == 8),3]
Dunc_month$PPT09 <- month_dunc_p[which(month_dunc_p$month == 9),3]
Dunc_month$PPT10 <- month_dunc_p[which(month_dunc_p$month == 10),3]
Dunc_month$PPT11 <- month_dunc_p[which(month_dunc_p$month == 11),3]
Dunc_month$PPT12 <- month_dunc_p[which(month_dunc_p$month == 12),3]

png(filename = "Figure_6_monthly_temperature_Env_Can.png",height = 600, width = 1700, res = 170) #Not for manuscript
par(mfrow=c(1,3), cex.lab=1.25,mai=c(0.55,0.55,0.35,0.1))
dblFit(as.vector(as.matrix(Dunc_month[,c(15:26)])),as.vector(as.matrix(site_month[c(2,13,24,35),c(15:26)])),as.vector(as.matrix(model_month[c(2,13,24,35),c(15:26)])),order=1, rmse=T, xlab="",ylab="",cex=1.3,xlim=c(-35,15),ylim=c(-35,15),main="Minimum temperature")
abline(b=1,a=0,lty=2)
dblFit(as.vector(as.matrix(Dunc_month[,c(3:14)])),as.vector(as.matrix(site_month[c(2,13,24,35),c(3:14)])),as.vector(as.matrix(model_month[c(2,13,24,35),c(3:14)])),order=1, rmse=T, xlab="",ylab="",cex=1.3,xlim=c(-35,15),ylim=c(-35,15),main="Maximum temperature")
abline(b=1,a=0,lty=2)
dblFit(as.vector(as.matrix(Dunc_month[,c(27:38)])),as.vector(as.matrix(site_month[c(2,13,24,35),c(27:38)])),as.vector(as.matrix(model_month[c(2,13,24,35),c(27:38)])),order=1, rmse=T, xlab="",ylab="",cex=1.3,xlim=c(-35,15),ylim=c(-35,15),main="Average temperature")
abline(b=1,a=0,lty=2)
dev.off()
dblFit(as.vector(as.matrix(Dunc_month[,c(39:50)])),as.vector(as.matrix(site_month[c(2,13,24,35),c(39:50)])),as.vector(as.matrix(model_month[c(2,13,24,35),c(39:50)])),order=1, rmse=T, xlab="",ylab="",cex=1.3,xlim=c(0,250),ylim=c(0,250),main="Monthly precipitation")
abline(b=1,a=0,lty=2)


```